t = 'LKZZOVCHNARZRLPJMONRAOXIUPMCPQEQXPLUPSSXOOVZRNSXOXPCCSXONCRRADPVILXOZPVZNOCCSRPVKVEVRJVZOTSXSXORKSOAZRRAQRKCZRVCHMOAOPQXOZMHPLCOVZOAMAIZWORNLSRVOJISXRKSEOAMRAAPICSXPSLTPVVOZSXOQXPLUJISXRVOQKADIVWLTAIVWRNNINSHNOOSISJPLPVPVQIOVSZONOVQORNSXOZJPADOLPWPIVLSPVHOVOUHSXPSUIWXSQPTSKAOSXONIALSXPCCPVZSXORKSOATPLLPWOLSXOHQRKCZRVCHTPLLPQARLLISIVLIVWCONICOPSSXOMAIVEWPVZPCNXPCSOZPVZSXORSXOALQPUOKTIVPTPQEMOXIVZCOPZSXOJPHWIUCIXOLPIZTITTIVPVZUOAAHVOFSLSAPIWXSRVPVZKTSXOLSPIAMOHRVZSXOZRRAPAARJLNOCCPURVWSXOURVOLSAKQENARZRPVZLTAPVWMPQEPVRSXOATIOAQOZWPVZPCNLXPSPVZLSKQESXOAOCIEOPMCPQENOPSXOANARZRCRREOZMOXIVZMOHRVZSXONIAOXOLPJLJPAUIVWMCPQENIWKAOLSXOAOLOOUOZSRMOXKVZAOZLRNRAQLSXOHMAPVZILXOZLTOPALPVZLQIUISPALJXIQXLXRVOAOZPLMCRRZIVSXONIAOCIWXSARCCOZSXOZAKUMOPSLWARJIVWCRKZOAPVZZRRUZRRUCRKZOAZRRUZRRUCOWRCPLSKAVOZPVZLOSPVPAARJSRSXOLSAIVWSXRKWXISJPLPCRVWLXRSNRAXILLUPCCMRJXOZAOJMKSXILXPVZNOCCPVZSXOPAARJLCITTOZSRSXOWARKVZXOWPDOPQAHRNZILUPHPVZNOPASJRWAOPSSARCCLPTTOPAOZSXOHMRAOWAOPSLCPMLRNLSRVOPVZNCKVWSXOUZRJVSRLOADOPLWPVWJPHLRDOASXONIAOMKSISJPLVRSSXOSARCCLSXPSXPZNICCOZSXOOCNJISXSOAARASXOAPVELRNSXORAQLXPZRTOVOZPVZSXOHQARJZOZPJPHPLINSXOHSXOULOCDOLJOAOPNAPIZLRUOSXIVWJPLQRUIVWKTMOXIVZSXOUJXPSISJPLQRKCZVRSMOLOOVISJPLCIEOPWAOPSLXPZRJIVSXOUIZZCORNJXIQXJPLPZPAENRAURNUPVLXPTOUPHMOHOSWAOPSOAPVZPTRJOAPVZSOAARALOOUOZSRMOIVISPVZSRWRMONRAOISISQPUOSRSXOOZWORNSXONIAOPVZSXOCIWXSNPZOZPLINPQCRKZXPZMOVSRDOAISSXOVJISXPAKLXISCOPTOZPQARLLSXONILLKAOSXONCPUOLARPAOZKTSRWAOOSISPVZJAOPSXOZPMRKSISPVZPMCPQELUREOLJIACOZIVSXOPIAISLLSAOPUIVWUPVOEIVZCOZPVZMCPGOZMOXIVZISIVISLAIWXSXPVZJPLPMCPZOCIEOPLSPMMIVWSRVWKORNNIAOIVISLCONSISXOCZPJXITRNUPVHSXRVWLPIPIJPICOZCOWRCPLPMPCARWPMPCARWILQRUOWIUCILSPAOZJISXJIZOOHOLZKAIVLMPVOXOQAIOZPVZCOSSIVWXILPFONPCCXOQRDOAOZXILNPQOPMPCARWUKSSOAOZWPVZPCNVRJIKVZOALSPVZXONPCSOAOZPVZCOPVOZXOPDICHRVXILLSPNNJXPSPVODICNRASKVOPVZIPUPCAOPZHJOPAHSXOZPAENIWKAOLSAOPUIVWJISXNIAOAPQOZSRJPAZLSXOUSXORAQLHOCCOZPVZTRKAOZRDOASXOLSRVOWPVWJPHLSXOVMRARUIAAPILOZXILXRAVPVZMCOJCRKZSXOQXPCCOVWOAPVWPVZMOCCRJOZCIEOSXOLXRKSRNUPVHSXARPSLKVZOASXOQPDOAVRKLARRNNRAPURUOVSSXORAQLYKPICOZPVZSXONIOAHLXPZRJXPCSOZSXOVSXOOQXROLZIOZPLLKZZOVCHPLPNCPUOMCRJVRKSMHPZPAEJIVZPVZSXOOVOUHPZDPVQOZPWPIVRDOASXOMAIZWOQAIOZWPVZPCNAOQPCCIVWXILLSAOVWSXNCHSXILILPNROMOHRVZPVHRNHRKIUKLSXRCZSXOVPAARJJPHNCHPAPWRAVPVZMRARUIAZIZVRSXOOZSXOQRUUPVZMKSLSICCXOCZSXOIAWARKVZLIZOMHLIZOMOXIVZWPVZPCNPSSXONPAOVZRNSXOMAIZWOSXORSXOALXPCSOZBKLSJISXIVSXOZRRAJPHPSSXOXPCCLOVZPVZSKAVOZKVPMCOSRCOPDOSXOIACOPZOASRNPQOSXOOVOUHPCRVOSXOMPCARWAOPQXOZSXOMAIZWOWPVZPCNLSRRZIVSXOUIZZCORNSXOLTPVCOPVIVWRVSXOLSPNNIVXILCONSXPVZMKSIVXILRSXOAXPVZWCPUZAIVWWCOPUOZQRCZPVZJXISOXILOVOUHXPCSOZPWPIVNPQIVWXIUPVZSXOLXPZRJPMRKSISAOPQXOZRKSCIEOSJRDPLSJIVWLISAPILOZSXOJXITPVZSXOSXRVWLJXIVOZPVZQAPQEOZNIAOQPUONARUISLVRLSAICLMKSWPVZPCNLSRRZNIAUHRKQPVVRSTPLLXOLPIZSXORAQLLSRRZLSICCPVZPZOPZLICOVQONOCCIPUPLOADPVSRNSXOLOQAOSNIAOJIOCZOARNSXONCPUORNPVRAHRKQPVVRSTPLLSXOZPAENIAOJICCVRSPDPICHRKNCPUORNKZHVWRMPQESRSXOLXPZRJHRKQPVVRSTPLLSXOMPCARWUPZOVRPVLJOASXONIAOIVISLOOUOZSRZIOMKSSXOZPAEVOLLWAOJISLSOTTOZNRAJPAZLCRJCHRVSRSXOMAIZWOPVZLKZZOVCHISZAOJISLOCNKTSRPWAOPSXOIWXSPVZISLJIVWLJOAOLTAOPZNARUJPCCSRJPCCMKSLSICCWPVZPCNQRKCZMOLOOVWCIUUOAIVWIVSXOWCRRUXOLOOUOZLUPCCPVZPCSRWOSXOAPCRVOWAOHPVZMOVSCIEOPJIGOVOZSAOOMONRAOSXORVLOSRNPLSRAUNARURKSRNSXOLXPZRJPAOZLJRAZCOPTOZNCPUIVWWCPUZAIVWWCISSOAOZJXISOIVPVLJOASXOAOJPLPAIVWIVWQCPLXPVZPLSPMRNJXISONIAOSXOMPCARWNOCCMPQEPVZISLLJRAZNCOJKTIVURCSOVNAPWUOVSLSXOJIGPAZLJPHOZRVSXOMAIZWOLSOTTOZMPQEPTPQOPVZSXOVPWPIVLSRRZLSICCHRKQPVVRSTPLLXOLPIZJISXPMRKVZSXOMPCARWCOPTOZNKCCKTRVSXOMAIZWOISLJXITJXIACOZPVZXILLOZXOQPVVRSLSPVZPCRVOQAIOZPAPWRAVLKZZOVCHPVZAPVMPQEPCRVWSXOMAIZWOXOLXRKSOZIPUJISXHRKWPVZPCNOCOVZICWRVZRAQAIOZMRARUIAPVZCOPTOZPNSOAXIUPSSXPSURUOVSWPVZPCNCINSOZXILLSPNNPVZQAHIVWPCRKZXOLURSOSXOMAIZWOMONRAOXIUSXOLSPNNMAREOPLKVZOAPVZNOCCNARUXILXPVZPMCIVZIVWLXOOSRNJXISONCPUOLTAPVWKTSXOMAIZWOQAPQEOZAIWXSPSSXOMPCARWLNOOSISMAREOPVZSXOLSRVOKTRVJXIQXISLSRRZQAPLXOZIVSRSXOWKCNJXICOSXOAOLSAOUPIVOZTRILOZYKIDOAIVWCIEOPSRVWKORNARQESXAKLSRKSIVSROUTSIVOLLJISXPSOAAIMCOQAHSXOMPCARWNOCCNRAJPAZPVZISLLXPZRJTCKVWOZZRJVPVZDPVILXOZMKSODOVPLISNOCCISLJKVWISLJXITPVZSXOSXRVWLCPLXOZPVZQKACOZPMRKSSXOJIGPAZLEVOOLZAPWWIVWXIUSRSXOMAIVEXOLSPWWOAOZPVZNOCCWAPLTOZDPIVCHPSSXOLSRVOPVZLCIZIVSRSXOPMHLLNCHHRKNRRCLXOQAIOZPVZJPLWRVO';
%t = 'abriegre'
key = gen_key([1 1 0 1 0 1 0 1]);
kt = encode(t,key)
diff = double(kt)-double(t);
freq = zeros(1,256);
for i=1:size(kt,2)
    freq(double(kt(i))) = freq(double(kt(i))) + 1;
end
plot(double(kt),double(kt),'.r')
hold on;
decode(encode('LKZZOVCHNARZRLPJMONRAOXIUPMCPQEQXPLUPSSXOOVZRNSXOXPCCSXONCRRADPVILXOZPVZNOCCSRPVKVEVRJVZOTSXSXORKSOAZRRAQRKCZRVCHMOAOPQXOZMHPLCOVZOAMAIZWORNLSRVOJISXRKSEOAMRAAPICSXPSLTPVVOZSXOQXPLUJISXRVOQKADIVWLTAIVWRNNINSHNOOSISJPLPVPVQIOVSZONOVQORNSXOZJPADOLPWPIVLSPVHOVOUHSXPSUIWXSQPTSKAOSXONIALSXPCCPVZSXORKSOATPLLPWOLSXOHQRKCZRVCHTPLLPQARLLISIVLIVWCONICOPSSXOMAIVEWPVZPCNXPCSOZPVZSXORSXOALQPUOKTIVPTPQEMOXIVZCOPZSXOJPHWIUCIXOLPIZTITTIVPVZUOAAHVOFSLSAPIWXSRVPVZKTSXOLSPIAMOHRVZSXOZRRAPAARJLNOCCPURVWSXOURVOLSAKQENARZRPVZLTAPVWMPQEPVRSXOATIOAQOZWPVZPCNLXPSPVZLSKQESXOAOCIEOPMCPQENOPSXOANARZRCRREOZMOXIVZMOHRVZSXONIAOXOLPJLJPAUIVWMCPQENIWKAOLSXOAOLOOUOZSRMOXKVZAOZLRNRAQLSXOHMAPVZILXOZLTOPALPVZLQIUISPALJXIQXLXRVOAOZPLMCRRZIVSXONIAOCIWXSARCCOZSXOZAKUMOPSLWARJIVWCRKZOAPVZZRRUZRRUCRKZOAZRRUZRRUCOWRCPLSKAVOZPVZLOSPVPAARJSRSXOLSAIVWSXRKWXISJPLPCRVWLXRSNRAXILLUPCCMRJXOZAOJMKSXILXPVZNOCCPVZSXOPAARJLCITTOZSRSXOWARKVZXOWPDOPQAHRNZILUPHPVZNOPASJRWAOPSSARCCLPTTOPAOZSXOHMRAOWAOPSLCPMLRNLSRVOPVZNCKVWSXOUZRJVSRLOADOPLWPVWJPHLRDOASXONIAOMKSISJPLVRSSXOSARCCLSXPSXPZNICCOZSXOOCNJISXSOAARASXOAPVELRNSXORAQLXPZRTOVOZPVZSXOHQARJZOZPJPHPLINSXOHSXOULOCDOLJOAOPNAPIZLRUOSXIVWJPLQRUIVWKTMOXIVZSXOUJXPSISJPLQRKCZVRSMOLOOVISJPLCIEOPWAOPSLXPZRJIVSXOUIZZCORNJXIQXJPLPZPAENRAURNUPVLXPTOUPHMOHOSWAOPSOAPVZPTRJOAPVZSOAARALOOUOZSRMOIVISPVZSRWRMONRAOISISQPUOSRSXOOZWORNSXONIAOPVZSXOCIWXSNPZOZPLINPQCRKZXPZMOVSRDOAISSXOVJISXPAKLXISCOPTOZPQARLLSXONILLKAOSXONCPUOLARPAOZKTSRWAOOSISPVZJAOPSXOZPMRKSISPVZPMCPQELUREOLJIACOZIVSXOPIAISLLSAOPUIVWUPVOEIVZCOZPVZMCPGOZMOXIVZISIVISLAIWXSXPVZJPLPMCPZOCIEOPLSPMMIVWSRVWKORNNIAOIVISLCONSISXOCZPJXITRNUPVHSXRVWLPIPIJPICOZCOWRCPLPMPCARWPMPCARWILQRUOWIUCILSPAOZJISXJIZOOHOLZKAIVLMPVOXOQAIOZPVZCOSSIVWXILPFONPCCXOQRDOAOZXILNPQOPMPCARWUKSSOAOZWPVZPCNVRJIKVZOALSPVZXONPCSOAOZPVZCOPVOZXOPDICHRVXILLSPNNJXPSPVODICNRASKVOPVZIPUPCAOPZHJOPAHSXOZPAENIWKAOLSAOPUIVWJISXNIAOAPQOZSRJPAZLSXOUSXORAQLHOCCOZPVZTRKAOZRDOASXOLSRVOWPVWJPHLSXOVMRARUIAAPILOZXILXRAVPVZMCOJCRKZSXOQXPCCOVWOAPVWPVZMOCCRJOZCIEOSXOLXRKSRNUPVHSXARPSLKVZOASXOQPDOAVRKLARRNNRAPURUOVSSXORAQLYKPICOZPVZSXONIOAHLXPZRJXPCSOZSXOVSXOOQXROLZIOZPLLKZZOVCHPLPNCPUOMCRJVRKSMHPZPAEJIVZPVZSXOOVOUHPZDPVQOZPWPIVRDOASXOMAIZWOQAIOZWPVZPCNAOQPCCIVWXILLSAOVWSXNCHSXILILPNROMOHRVZPVHRNHRKIUKLSXRCZSXOVPAARJJPHNCHPAPWRAVPVZMRARUIAZIZVRSXOOZSXOQRUUPVZMKSLSICCXOCZSXOIAWARKVZLIZOMHLIZOMOXIVZWPVZPCNPSSXONPAOVZRNSXOMAIZWOSXORSXOALXPCSOZBKLSJISXIVSXOZRRAJPHPSSXOXPCCLOVZPVZSKAVOZKVPMCOSRCOPDOSXOIACOPZOASRNPQOSXOOVOUHPCRVOSXOMPCARWAOPQXOZSXOMAIZWOWPVZPCNLSRRZIVSXOUIZZCORNSXOLTPVCOPVIVWRVSXOLSPNNIVXILCONSXPVZMKSIVXILRSXOAXPVZWCPUZAIVWWCOPUOZQRCZPVZJXISOXILOVOUHXPCSOZPWPIVNPQIVWXIUPVZSXOLXPZRJPMRKSISAOPQXOZRKSCIEOSJRDPLSJIVWLISAPILOZSXOJXITPVZSXOSXRVWLJXIVOZPVZQAPQEOZNIAOQPUONARUISLVRLSAICLMKSWPVZPCNLSRRZNIAUHRKQPVVRSTPLLXOLPIZSXORAQLLSRRZLSICCPVZPZOPZLICOVQONOCCIPUPLOADPVSRNSXOLOQAOSNIAOJIOCZOARNSXONCPUORNPVRAHRKQPVVRSTPLLSXOZPAENIAOJICCVRSPDPICHRKNCPUORNKZHVWRMPQESRSXOLXPZRJHRKQPVVRSTPLLSXOMPCARWUPZOVRPVLJOASXONIAOIVISLOOUOZSRZIOMKSSXOZPAEVOLLWAOJISLSOTTOZNRAJPAZLCRJCHRVSRSXOMAIZWOPVZLKZZOVCHISZAOJISLOCNKTSRPWAOPSXOIWXSPVZISLJIVWLJOAOLTAOPZNARUJPCCSRJPCCMKSLSICCWPVZPCNQRKCZMOLOOVWCIUUOAIVWIVSXOWCRRUXOLOOUOZLUPCCPVZPCSRWOSXOAPCRVOWAOHPVZMOVSCIEOPJIGOVOZSAOOMONRAOSXORVLOSRNPLSRAUNARURKSRNSXOLXPZRJPAOZLJRAZCOPTOZNCPUIVWWCPUZAIVWWCISSOAOZJXISOIVPVLJOASXOAOJPLPAIVWIVWQCPLXPVZPLSPMRNJXISONIAOSXOMPCARWNOCCMPQEPVZISLLJRAZNCOJKTIVURCSOVNAPWUOVSLSXOJIGPAZLJPHOZRVSXOMAIZWOLSOTTOZMPQEPTPQOPVZSXOVPWPIVLSRRZLSICCHRKQPVVRSTPLLXOLPIZJISXPMRKVZSXOMPCARWCOPTOZNKCCKTRVSXOMAIZWOISLJXITJXIACOZPVZXILLOZXOQPVVRSLSPVZPCRVOQAIOZPAPWRAVLKZZOVCHPVZAPVMPQEPCRVWSXOMAIZWOXOLXRKSOZIPUJISXHRKWPVZPCNOCOVZICWRVZRAQAIOZMRARUIAPVZCOPTOZPNSOAXIUPSSXPSURUOVSWPVZPCNCINSOZXILLSPNNPVZQAHIVWPCRKZXOLURSOSXOMAIZWOMONRAOXIUSXOLSPNNMAREOPLKVZOAPVZNOCCNARUXILXPVZPMCIVZIVWLXOOSRNJXISONCPUOLTAPVWKTSXOMAIZWOQAPQEOZAIWXSPSSXOMPCARWLNOOSISMAREOPVZSXOLSRVOKTRVJXIQXISLSRRZQAPLXOZIVSRSXOWKCNJXICOSXOAOLSAOUPIVOZTRILOZYKIDOAIVWCIEOPSRVWKORNARQESXAKLSRKSIVSROUTSIVOLLJISXPSOAAIMCOQAHSXOMPCARWNOCCNRAJPAZPVZISLLXPZRJTCKVWOZZRJVPVZDPVILXOZMKSODOVPLISNOCCISLJKVWISLJXITPVZSXOSXRVWLCPLXOZPVZQKACOZPMRKSSXOJIGPAZLEVOOLZAPWWIVWXIUSRSXOMAIVEXOLSPWWOAOZPVZNOCCWAPLTOZDPIVCHPSSXOLSRVOPVZLCIZIVSRSXOPMHLLNCHHRKNRRCLXOQAIOZPVZJPLWRVO',gen_key([1 1 0 1 0 1 0 1])),gen_key([1 1 0 1 0 1 0 1]))