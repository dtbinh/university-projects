/*
 * FILE: passwords.flex
 *
 * PURPOSE: Define flex specification for password validator
 *
 * AUTHOR: McElory Hoffmann
 *
 * DATE: 7 February 2004
 */

/* Define some names that recognise invalid passwords */
/* Password contains no capital letter */
no_caps ([^A-Z\n])*

/* Password contains capital letters, but no lowercase letters */
no_lowercase ([^a-z\nA-Z])*[A-Z]+([^a-z\n])*

/* Password contains capital letters, but no digits */
no_digit ([^0-9\nA-Z])*[A-Z]+([^0-9\n])*

/* Password contains whitespace */
spaces ([ \t]*[^ \t\n])+[ \t]+([^\n])+

/* Password is too short */
too_short .{1,7}

%%

"quit"		{ printf( "Bye bye\n" ); return; }
{no_caps}       printf( "Password contains no capital letter\n" );
{no_lowercase}  printf( "Password contains no lowercase letters\n" );
{no_digit}      printf( "Password contains no digits\n" );
{spaces}        printf( "Password contains whitespace\n" );
{too_short}     printf( "Password is too short\n" );
.*              printf( "Valid password\n" );

%%
int main()
{
    yylex();
	return EXIT_SUCCESS;
}

